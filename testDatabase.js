'use strict';const Database=require("./"),fs=require("fs"),database=new Database(__dirname+"/");try{new Database(__dirname+"/shouldFail.js"),console.log(new Error("new Database() failed")),process.exit(1)}catch(a){}try{const a=new Database(__dirname+"/utils/");fs.unlinkSync(a.filePath),fs.rmdirSync(a.filePath.replace("/database.json",""))}catch(a){console.log(new Error("new Database() failed")),process.exit(1)}if(database.filePath!==__dirname+"/database.json")throw new Error("FilePath is incorrect");if(2!==database.spaces)throw new Error("Spaces is incorrect");database.clear(),database.set("set1","").set("set2",1).set("set3",[]).set("set4",{}).set("set5",null).set("add",1).set("sub",3).set("delete","Oh, No! I'm gonna get deleted!"),database.add("add").add("add",2),database.sub("sub").sub("sub",2);const deleted=database.delete("delete");if(!deleted||database.has("delete"))throw new Error("delete() failed");let listener=()=>{throw new Error("Change event fired when not supposed to")};database.addListener("change",listener),database.set("set1","").set("set2",1).set("set3",[]).set("set4",{}).set("set5",null),database.delete("delete"),database.add("add",0).sub("sub",0),database.removeListener("change",listener),listener=a=>{if(a!==expectedValue)throw new TypeError(`Value didn't match expected value\nExpected: ${expectedValue}\nRecieved: ${a}`)};let expectedValue="";listener(database.get("set1")),expectedValue=1,listener(database.get("set2")),expectedValue=JSON.stringify([]),listener(JSON.stringify(database.get("set3"))),expectedValue=JSON.stringify({}),listener(JSON.stringify(database.get("set4"))),expectedValue=null,listener(database.get("set5")),expectedValue=void 0,listener(database.get("set6")),expectedValue=`{"set1":"","set2":1,"set3":[],"set4":{},"set5":null,"add":4,"sub":0}`,listener(JSON.stringify(database.read())),expectedValue=JSON.stringify(database.read(),null,2),listener(database.toString()),database.set("obj",{nest1:{nest2:{value2:"I'm a value!"},value1:"Boo!",duplicateOfValue1:"Boo!"}}),expectedValue=JSON.stringify(database.get("obj")),listener(JSON.stringify(database.find("",a=>a&&a.nest1))),expectedValue=JSON.stringify(database.get("obj.nest1")),listener(JSON.stringify(database.find("obj",a=>a.nest2&&a.nest2.value2))),expectedValue=JSON.stringify([database.get("obj")]),listener(JSON.stringify(database.findAll("",a=>a&&a.nest1))),expectedValue=JSON.stringify([database.get("obj.nest1")]),listener(JSON.stringify(database.findAll("obj",a=>a.nest2&&a.nest2.value2))),expectedValue=JSON.stringify([database.get("obj.nest1.value1"),database.get("obj.nest1.duplicateOfValue1")]),listener(JSON.stringify(database.findAll("obj.nest1",a=>"Boo!"===a))),[1,"1"].forEach(b=>{expectedValue=JSON.stringify(database.read(),null,+b),database.setSpaces(b),listener(database.toString()),expectedValue=+b,listener(database.spaces)});let d={str:database.toString(),filePath:database.filePath};if(database.moveTo(__dirname+"/database1"),fs.existsSync(d.filePath))throw new Error("moveTo() failed");if(d.str!==database.toString())throw new Error("moveTo() failed");if(d={str:database.toString(),filePath:database.filePath},database.moveTo(__dirname+"/database2",!1),!fs.existsSync(d.filePath))throw new Error("moveTo() failed");if(d.str!==database.toString())throw new Error("moveTo() failed");if(database.clear(),"{}"!==database.toString())throw new Error("clear() failed");fs.unlinkSync(database.filePath),fs.unlinkSync(d.filePath),console.log("Database is working properly");